#include <Arduino.h>

// Use UART2 (pins 16 = RX, 17 = TX on ESP32)
HardwareSerial RadarSerial(2);

// Command to send (11 bytes)
uint8_t cmd[] = {0x68, 0x05, 0x05, 0x68, 0x80, 0x01, 0xDA, 0x01, 0x20, 0x7C, 0x16};

void setup() {
  Serial.begin(115200);        
  RadarSerial.begin(115200, SERIAL_8N1, 16, 17); // baud, config, RX, TX
  Serial.println("Starting...");
}

void loop() {
  // --- Send Command ---
  Serial.print("TX: ");
  for (int i = 0; i < sizeof(cmd); i++) {
    if (cmd[i] < 0x10) Serial.print("0");
    Serial.print(cmd[i], HEX);
    Serial.print(" ");
  }
  Serial.println();

  RadarSerial.write(cmd, sizeof(cmd));

  // --- Receive Response ---
  if (RadarSerial.available()) {
    Serial.print("RX: ");
    while (RadarSerial.available()) {
      uint8_t b = RadarSerial.read();
      if (b < 0x10) Serial.print("0");
      Serial.print(b, HEX);
      Serial.print(" ");
    }
    Serial.println();
  }

  delay(100); // 100 ms
}
